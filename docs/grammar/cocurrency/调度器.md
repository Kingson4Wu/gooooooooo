

## 《Go语言精进之路》调度器状态的查看方法


+ Go提供了调度器当前状态的查看方法：使用Go运行时环境变量GODEBUG。

+ 给GODEBUG传入了"schedtrace=1000"，其含义就是每1000ms打印输出一次goroutine调度器的状态，每次一行。

` SCHED 6016ms: gomaxprocs=4 idleprocs=0 threads=26 spinningthreads=0 idlethreads=20 runqueue=1 [3 4 0 10]`

•  SCHED：调试信息输出标志字符串，代表本行是goroutine调度器相关信息的输出。
•  6016ms：从程序启动到输出这行日志经过的时间。
•  gomaxprocs：P的数量。
•  idleprocs：处于空闲状态的P的数量。通过gomaxprocs和idleprocs的差值，我们就可以知道当前正在执行Go代码的P的数量。
•  threads：操作系统线程的数量，包含调度器使用的M数量，加上运行时自用的类似sysmon这样的线程的数量。
•  spinningthreads：处于自旋（spin）状态的操作系统数量。
•  idlethread：处于空闲状态的操作系统线程的数量。
•  runqueue=1：Go调度器全局运行队列中G的数量。
•  [3 4 0 10]：分别为4个P的本地运行队列中的G的数量。

+ 还可以输出每个goroutine、M和P的详细调度信息（对于Gopher来说，在大多数情况下这是不必要的）：
`$ GODEBUG=schedtrace=1000,scheddetail=1 godoc -http=:6060`

+  关于Go调度器调试信息输出的详细信息，可以参考Dmitry Vyukov的文章 “ Debugging Performance Issues in Go Programs”[1]，这也应该是每个Gopher必读的经典文章。更详尽的信息可参考$GOROOT/src/runtime/proc.go中schedtrace函数的实现。

`[1]https://software.intel.com/en-us/blogs/2014/05/10/debugging-performance-issues-in-go-programs`


+ 程序已经运行中了,怎么查看????重启??TODO